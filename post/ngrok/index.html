<!doctype html><html lang=en><head><meta charset=utf-8><meta name=generator content="Hugo 0.79.1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content><meta property="og:url" content="https://blog.qlf.io/post/ngrok/"><link rel=canonical href=https://blog.qlf.io/post/ngrok/><link rel=preload href=/js/highlight.pack.js as=script><link rel=alternate type=application/atom+xml href=https://blog.qlf.ioindex.xml title="Scott Qian"><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/blog.qlf.io"},"articleSection":"post","name":"ngrok","headline":"ngrok","description":"ngrok 是一款内网穿透神器，可以直接将内网的端口暴露到外网，实在是居家必备神器。\n下载并安装 Go cd ~\/download wget https:\/\/storage.googleapis.com\/golang\/go1.4.2.linux-amd64.tar.gz tar -xvf go1.4.2.linux-amd64.tar.gz cp -R go \/usr\/local cp \/usr\/local\/go\/bin\/* \/usr\/bin 下载 ngrok cd ~\/github git clone https:\/\/github.com\/inconshreveable\/ngrok.git cd ngrok 开始编译 ngrok  首先为根域名生成证书  export NGROK_DOMAIN=\u0026#34;yourdomain.com\u0026#34; openssl genrsa -out rootCA.key 2048 openssl req -x509 -new -nodes -key rootCA.key -subj \u0026#34;\/CN=$NGROK_DOMAIN\u0026#34; -days 5000 -out rootCA.pem openssl genrsa -out device.key 2048 openssl req -new -key device.key -subj \u0026#34;\/CN=$NGROK_DOMAIN\u0026#34; -out device.csr openssl x509 -req -in device.","inLanguage":"en-US","author":"","creator":"","publisher":"","accountablePerson":"","copyrightHolder":"","copyrightYear":"2015","datePublished":"2015-07-16 17:57:17 \u002b0000 UTC","dateModified":"2015-07-16 17:57:17 \u002b0000 UTC","url":"https:\/\/blog.qlf.io\/post\/ngrok\/","keywords":[]}</script><title>ngrok - Scott Qian</title><meta property="og:title" content="ngrok - Scott Qian"><meta property="og:type" content="article"><meta property="og:description" content="ngrok 是一款内网穿透神器，可以直接将内网的端口暴露到外网，实在是居家必备神器。
下载并安装 Go cd ~/download wget https://storage.googleapis.com/golang/go1.4.2.linux-amd64.tar.gz tar -xvf go1.4.2.linux-amd64.tar.gz cp -R go /usr/local cp /usr/local/go/bin/* /usr/bin 下载 ngrok cd ~/github git clone https://github.com/inconshreveable/ngrok.git cd ngrok 开始编译 ngrok  首先为根域名生成证书  export NGROK_DOMAIN=&#34;yourdomain.com&#34; openssl genrsa -out rootCA.key 2048 openssl req -x509 -new -nodes -key rootCA.key -subj &#34;/CN=$NGROK_DOMAIN&#34; -days 5000 -out rootCA.pem openssl genrsa -out device.key 2048 openssl req -new -key device.key -subj &#34;/CN=$NGROK_DOMAIN&#34; -out device.csr openssl x509 -req -in device."><meta name=description content="ngrok 是一款内网穿透神器，可以直接将内网的端口暴露到外网，实在是居家必备神器。
下载并安装 Go cd ~/download wget https://storage.googleapis.com/golang/go1.4.2.linux-amd64.tar.gz tar -xvf go1.4.2.linux-amd64.tar.gz cp -R go /usr/local cp /usr/local/go/bin/* /usr/bin 下载 ngrok cd ~/github git clone https://github.com/inconshreveable/ngrok.git cd ngrok 开始编译 ngrok  首先为根域名生成证书  export NGROK_DOMAIN=&#34;yourdomain.com&#34; openssl genrsa -out rootCA.key 2048 openssl req -x509 -new -nodes -key rootCA.key -subj &#34;/CN=$NGROK_DOMAIN&#34; -days 5000 -out rootCA.pem openssl genrsa -out device.key 2048 openssl req -new -key device.key -subj &#34;/CN=$NGROK_DOMAIN&#34; -out device.csr openssl x509 -req -in device."><meta property="og:locale" content><link rel=stylesheet href=/css/flexboxgrid-6.3.1.min.css><link rel=stylesheet href=/css/github-markdown.css><link rel=stylesheet href=/css/highlight/tomorrow.min.css><link rel=stylesheet href=/css/index.css><link href=/index.xml rel=alternate type=application/rss+xml title="Scott Qian"><link href="https://fonts.googleapis.com/css?family=Arvo|Permanent+Marker|Bree+Serif" rel=stylesheet></head><body><article class=post id=article><div class=row><div class=col-xs-12><div class=site-header><header><div class="signatures site-title"><a href=/>Scott Qian</a></div></header><div class="row end-xs"></div><div class=header-line></div></div><header class=post-header><h1 class=post-title>ngrok</h1><div class="row post-desc"><div class=col-xs-6><time class=post-date datetime="2015-07-16 17:57:17 UTC">16 Jul 2015</time></div><div class=col-xs-6></div></div></header><div class="post-content markdown-body"><p>ngrok 是一款内网穿透神器，可以直接将内网的端口暴露到外网，实在是居家必备神器。</p><h1 id=下载并安装-go>下载并安装 Go</h1><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>cd ~/download
wget https://storage.googleapis.com/golang/go1.4.2.linux-amd64.tar.gz
tar -xvf  go1.4.2.linux-amd64.tar.gz
cp -R go /usr/local
cp /usr/local/go/bin/* /usr/bin
</code></pre></div><h1 id=下载-ngrok>下载 ngrok</h1><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>cd ~/github
git clone https://github.com/inconshreveable/ngrok.git
cd ngrok
</code></pre></div><h1 id=开始编译-ngrok>开始编译 ngrok</h1><ul><li>首先为根域名生成证书</li></ul><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>export NGROK_DOMAIN<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;yourdomain.com&#34;</span>
openssl genrsa -out rootCA.key <span style=color:#ae81ff>2048</span>
openssl req -x509 -new -nodes -key rootCA.key -subj <span style=color:#e6db74>&#34;/CN=</span>$NGROK_DOMAIN<span style=color:#e6db74>&#34;</span> -days <span style=color:#ae81ff>5000</span> -out rootCA.pem
openssl genrsa -out device.key <span style=color:#ae81ff>2048</span>
openssl req -new -key device.key -subj <span style=color:#e6db74>&#34;/CN=</span>$NGROK_DOMAIN<span style=color:#e6db74>&#34;</span> -out device.csr
openssl x509 -req -in device.csr -CA rootCA.pem -CAkey rootCA.key -CAcreateserial -out device.crt -days <span style=color:#ae81ff>5000</span>
cp rootCA.pem assets/client/tls/ngrokroot.crt
cp device.crt assets/server/tls/snakeoil.crt
cp device.key assets/server/tls/snakeoil.key
</code></pre></div><ul><li>编译服务器端</li></ul><pre><code>GOOS=linux GOARCH=amd64
#如果是32位系统，这里 GOARCH=386
</code></pre><p>然后 make</p><pre><code>make release-server
</code></pre><ul><li>编译 Windows 客户端</li></ul><pre><code>cd /usr/local/go/src
GOOS=windows GOARCH=amd64 ./make.bash
cd ~/github/ngrok
GOOS=windows GOARCH=amd64 make release-client
</code></pre><p>如果编译成功，应该在<code>bin/windows_amd64/</code>下产生一个<code>ngrok.exe</code></p><h1 id=运行>运行</h1><ul><li>启动服务端</li></ul><pre><code>./ngrokd -domain=&quot;yourdomain.com&quot; -httpAddr=&quot;:8080&quot; -httpsAddr=&quot;:445&quot;
</code></pre><ul><li>启动客户端
首先在 ngrok.exe 的同级目录新建一个配置文件 ngrok.conf</li></ul><pre><code>server_addr: &quot;yourdomain.com:4443&quot;
trust_host_root_certs: false
</code></pre><p>这里的 4443 是固定的，是 ngrok 在服务端监听的端口。</p><p>然后运行命令：</p><pre><code>ngrok.exe -subdomain oms -config=ngrok.conf 8081
</code></pre></div><div class="row middle-xs"><div class=col-xs-12></div></div><div class=row><div class=col-xs-12></div></div><div style=height:50px></div><div class=post-comments><div id=disqus_thread></div><script>window.addEventListener("load",()=>{(function(){var d=document,s=d.createElement("script");s.src="https://scottqian.disqus.com/embed.js";s.setAttribute("data-timestamp",+new Date());(d.head||d.body).appendChild(s);})();});</script><noscript>Please enable JavaScript to view the
<a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript></div><div class=site-footer><div class=site-footer-item><a href=https://github.com/qianlifeng target=_blank>Github</a></div></div></div></div></article><script src=/js/highlight.pack.js></script><script>hljs.initHighlightingOnLoad();</script></body></html>